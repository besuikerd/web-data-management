#19.5.3.1

list = LOAD 'title-and-actor.txt' USING PigStorage('\t') 
	AS (title:chararray, name:chararray, year:int, role:chararray); 

grouped = GROUP list BY title;
DUMP grouped;


#19.5.3.2

list = LOAD 'director-and-title.txt' USING PigStorage('\t')
	AS (director:chararray, title:chararray);

grouped = GROUP list BY director;
DUMP grouped;

#19.5.3.3

actors = LOAD 'title-and-actor.txt' USING PigStorage('\t') 
	AS (title:chararray, name:chararray, year:int, role:chararray); 

directors = LOAD 'director-and-title.txt' USING PigStorage('\t')
	AS (director:chararray, title:chararray);

joined = COGROUP actors BY title, directors BY title;

DUMP joined;

#19.5.3.4

movies = LOAD 'title-and-actor.txt' USING PigStorage('\t') 
	AS (title:chararray, name:chararray, year:int, role:chararray); 

directors = LOAD 'director-and-title.txt' USING PigStorage('\t')
	AS (name:chararray, title:chararray);


grouped = COGROUP movies BY name, directors BY name;

filtered = FILTER grouped by NOT IsEmpty(directors) AND NOT IsEmpty(movies);

DUMP filtered;

#19.5.3.5

actors = LOAD 'title-and-actor.txt' USING PigStorage('\t') 
	AS (title:chararray, name:chararray, year:int, role:chararray); 

directors = LOAD 'director-and-title.txt' USING PigStorage('\t')
	AS (director:chararray, title:chararray);
grouped = COGROUP actors BY name, directors BY director;
filtered = FILTER grouped by NOT IsEmpty(directors) AND NOT IsEmpty(actors);
joined = JOIN actors BY title, directors BY title;
filteredJoin = FILTER joined BY director == name;
generated = FOREACH filteredJoin GENERATE name;

das = JOIN generated by name, filtered by group;
dsa = FOREACH das GENERATE (name, actors, directors); 

DUMP dsa;